import{d as c,y as m,u as e,a as u}from"./index-y5u9UKsL.js";import{L as p}from"./loader-jG5UIMEw.js";import{u as g}from"./useEsp32Api-_9kM6RSB.js";const h=({onSubmit:l,initialValues:o,loading:i})=>{const[r,d]=c({broker:"",port:1883,user:"",password:"",topic:"homeassistant"});m(()=>{o&&d(o)},[o]);const n=t=>{t.preventDefault(),l(r)},a=t=>{const s=t.target;d({...r,[s.name]:s.type==="number"?Number(s.value):s.value})};return e("form",{onSubmit:n,className:"space-y-6",children:[e("div",{children:[e("label",{htmlFor:"broker",className:"block text-sm font-medium text-gray-700",children:"Broker Mqtt"}),e("div",{className:"mt-1",children:e("input",{id:"broker",name:"broker",type:"text",required:!0,value:r.broker,onChange:a,className:"block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 text-lg px-4 py-3"})})]}),e("div",{children:[e("label",{htmlFor:"broker",className:"block font-medium text-gray-700",children:"Mqtt port"}),e("div",{className:"mt-1",children:e("input",{id:"port",name:"port",type:"number",required:!0,value:r.port,onChange:a,className:"block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 text-lg px-4 py-3"})})]}),e("div",{children:[e("label",{htmlFor:"user",className:"block font-medium text-gray-700",children:"User"}),e("div",{className:"mt-1",children:e("input",{id:"user",name:"user",type:"text",required:!0,value:r.user,onChange:a,className:"block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 text-lg px-4 py-3"})})]}),e("div",{children:[e("label",{htmlFor:"password",className:"block font-medium text-gray-700",children:"Password"}),e("div",{className:"mt-1",children:e("input",{id:"password",name:"password",type:"password",required:!0,value:r.password,onChange:a,className:"block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 text-lg px-4 py-3"})})]}),e("div",{children:[e("label",{htmlFor:"topic",className:"block font-medium text-gray-700",children:"Mqtt Topic"}),e("div",{className:"mt-1",children:e("input",{id:"topic",name:"topic",type:"text",required:!0,value:r.topic,onChange:a,className:"block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 text-lg px-4 py-3"})})]}),e("div",{children:e("button",{type:"submit",className:"flex w-full justify-center rounded-md bg-indigo-600 px-3 py-2 text-sm font-semibold text-white shadow-sm hover:bg-indigo-500 focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-indigo-600",children:[i&&e(p,{className:"mr-2 h-5 w-5 animate-spin text-white"}),"Enregistrer"]})})]})};function v(l){const{setToast:o}=u(),{callApi:i,loading:r}=g(),[d,n]=c(null);return m(()=>{(async()=>{var s;const t=await i("/getConfig");t.success&&((s=t.data)!=null&&s.mqtt)&&n({broker:t.data.mqtt.server||"",port:t.data.mqtt.port||1883,user:t.data.mqtt.username||"",password:t.data.mqtt.password||"",topic:t.data.mqtt.topic||""})})()},[]),e("div",{className:"container p-8",children:e("div",{className:"divide-y divide-gray-200 overflow-hidden rounded-lg bg-white shadow",children:[e("div",{className:"px-4 py-5 sm:px-6 bg-indigo-600",children:e("h1",{className:"text-xl font-semibold text-white",children:"Paramètres Mqtt"})}),e("div",{className:"px-4 py-5 sm:p-6 bg-gray-100",children:e(h,{onSubmit:async t=>{(await i("/saveMqttSettings",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)})).success?o({message:"Paramètres MQTT enregistrés avec succès",type:"success"}):o({message:"Erreur lors de l'enregistrement des paramètres MQTT",type:"error"})},initialValues:d,loading:r})})]})})}export{v as default};
